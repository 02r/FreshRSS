<?php

$output = Minz_Request::param ('output', 'normal');
$token = $this->conf->token;
$token_param = Minz_Request::param ('token', '');
$token_is_ok = ($token != '' && $token == $token_param);

if(!login_is_conf ($this->conf) ||
   is_logged() ||
   Minz_Configuration::allowAnonymous() ||
   ($output == 'rss' && $token_is_ok)) {
	if($output == 'rss') {
		$this->renderHelper ('view/rss_view');
	} elseif($output == 'reader') {
		$this->renderHelper ('view/reader_view');
	} elseif($output == 'global') {
		$this->renderHelper ('view/global_view');
	} else {
		$this->renderHelper ('view/normal_view');
	}
} else {
?>
<div class="post content">
	<h1><?php echo Minz_Translate::t ('forbidden_access'); ?></h1>
	<p><?php echo Minz_Translate::t ('forbidden_access_description'); ?></p>
	<p><a href="<?php echo _url ('index', 'about'); ?>"><?php echo Minz_Translate::t ('about_freshrss'); ?></a></p>
</div>
<?php
}